{"version":3,"sources":["index.js"],"names":["loader_div","get_api_data","method","params","callback","http_request","XMLHttpRequest","p","i","open","replace","send","document","body","innerHTML","console","error","onreadystatechange","readyState","getElementById","remove","res","responseText","JSON","parse","log","show_page","page_name","user_id","localStorage","getItem","split","forEach","key","value","data","page","call_func","eval","fix_link","q","querySelectorAll","quest_count","elem","href","setAttribute","getAttribute","removeAttribute","onclick","ev","preventDefault","slice","quest_init","raw_data","innerText","header","text","howto"],"mappings":"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","file":"src.ba6fe809.js","sourceRoot":"../src","sourcesContent":["const loader_div = '<div id=\"loader\"></div>';\n\nfunction get_api_data(method, params, callback) {\n    const http_request = new XMLHttpRequest();\n    let p = '';\n    for (let i in params) {\n        p += i + '=' + params[i] + '&'\n    }\n\n    http_request.open('GET', '/api/' + method.replace('/', '') + '?' + p, true)\n    try{\n        http_request.send();\n        document.body.innerHTML = loader_div + document.body.innerHTML\n    }\n    catch{\n        console.error('Error in xhr');\n    }\n    http_request.onreadystatechange = function() {\n        if (http_request.readyState !== 4) return;\n        document.getElementById('loader').remove();\n        let res = http_request.responseText;\n        try {\n            res = JSON.parse(res);\n            return callback(res)\n        } catch {\n            console.log(\"RESPONSE TEXT:\", res);\n        }\n    }\n}\n\n\nfunction show_page(page_name, params) {\n    let p = {\n        page_name: page_name,\n        user_id: localStorage.getItem('user_id')\n    };\n    console.log(\"PARAMS:\", params);\n    if (params) {\n        params.split('&').forEach(i => {\n            let [key, value] = i.split('=');\n            p[key] = value\n        })\n    }\n    console.log(\"Show page with params:\", p);\n    get_api_data(\"get_page\", p, data => {\n        document.getElementById('content').innerHTML = data.page;\n        if (data.call_func) {\n            eval(data.call_func + \"(data)\");\n        }\n        fix_link();\n    })\n}\n\nfunction fix_link() {\n    console.log(\"Started fix...\");\n    // Fix link\n    let q = (document.querySelectorAll(\"a\"));\n    //console.log(q);\n    let quest_count = 0;\n    q.forEach(elem => {\n        elem.setAttribute('tab_link', elem.getAttribute('href'));\n        elem.setAttribute('href', '');\n        elem.removeAttribute('href');\n        let href = elem.getAttribute('tab_link');\n        switch (href) {\n            case '/quest_page.html':\n                elem.setAttribute('tab_link',\n                    '/quest_page');\n                quest_count++;\n                elem.setAttribute('params',\n                    'quest_id=' + quest_count + '&user_id=' + localStorage.getItem('user_id'))\n        }\n\n        elem.onclick = ev => {\n            ev.preventDefault();\n            console.log(\"Link to\", elem.getAttribute('tab_link'));\n            show_page(elem.getAttribute('tab_link').slice(1).replace('.html', ''),\n                elem.getAttribute('params'));\n            return false;\n        };\n    })\n}\n\nfunction quest_init(raw_data) {\n    let data = raw_data.data;\n    let body = document.getElementById('text');\n    document.getElementById('header_main').innerText = data.header;\n    data.body.forEach(elem => {\n        body.innerHTML += '<div class=\"fact\">' + elem.header + '</div>' +\n            '<div class=\"fact2\">' + elem.text + '</div> <br />'\n    });\n    document.getElementById('header_fix').innerText = data.howto.header;\n    document.getElementById('content_fix').innerText = data.howto.text;\n    console.log(data)\n}\n\nfix_link();"]}